"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("react"),e=require("react-dom");function n(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var o=n(t),r=function(){var t=navigator.userAgent.toLowerCase();return t.includes("win")?"windows":t.includes("macintosh")?"macOS":t.includes("x11")?"unix":t.includes("linux")&&!t.includes("android")?"linux":t.includes("iphone")?"iphone":t.includes("android")?"android":void 0},i="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},a={},s={},u={},l={};Object.defineProperty(l,"__esModule",{value:!0}),l.default={buttons:["A","B","X","Y","LB","RB","LT","RT","Back","Start","LS","RS","DPadUp","DPadDown","DPadLeft","DPadRight"],axis:["LeftStickX","-LeftStickY","RightStickX","-RightStickY"],buttonAxis:[null,null,null,null,null,null,"LeftTrigger","RightTrigger"]},Object.defineProperty(u,"__esModule",{value:!0}),u.XBOX=void 0;var c,d=(c=l)&&c.__esModule?c:{default:c};u.XBOX=d.default,u.default={XBOX:d.default},Object.defineProperty(s,"__esModule",{value:!0});var p=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),f=function(t){return t&&t.__esModule?t:{default:t}}(o.default),h=u;var v=function(t){function e(t,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var o=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n));return o.padState={connected:!1,buttons:{A:!1,B:!1,X:!1,Y:!1,LB:!1,LT:!1,LS:!1,RB:!1,RT:!1,RS:!1,Start:!1,Back:!1,DPadUp:!1,DPadRight:!1,DPadDown:!1,DPadLeft:!1},axis:{LeftStickX:0,LeftStickY:0,RightStickX:0,RightStickY:0,RightTrigger:0,LeftTrigger:0}},o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,f.default.Component),p(e,[{key:"componentDidMount",value:function(){this.mounted=!0,window&&window.requestAnimationFrame&&window.requestAnimationFrame(this.updateGamepad.bind(this))}},{key:"componentWillUnmount",value:function(){this.mounted=!1}},{key:"updateGamepad",value:function(){if(this.mounted){var t=this.props.gamepadIndex,e=navigator.getGamepads();if(e.length&&e.length>t&&e[t]){var n=e[t];this.padState.connected||(this.padState.connected=!0,this.props.onConnect(t)),this.updateAllButtons(n),this.updateAllAxis(n)}else this.padState.connected&&(this.padState.connected=!1,this.props.onDisconnect(t));window&&window.requestAnimationFrame&&window.requestAnimationFrame(this.updateGamepad.bind(this))}}},{key:"updateAllButtons",value:function(t){for(var e=0;e<t.buttons.length;++e){var n=t.buttons[e].pressed,o=t.buttons[e].value,r=this.buttonIndexToButtonName(e);this.updateButton(r,n);var i=this.buttonIndexToAxisName(e);this.updateAxis(i,o)}}},{key:"updateButton",value:function(t,e){void 0!==this.padState.buttons[t]&&this.padState.buttons[t]!==e&&(this.padState.buttons[t]=e,this.props.onButtonChange(t,e),this.props["onButton"+(e?"Down":"Up")](t),e&&this.props["on"+t.replace("DPad","")]())}},{key:"updateAllAxis",value:function(t){for(var e=0;e<t.axes.length;++e){var n=this.axisIndexToAxisName(e);t.axes[e],this.updateAxis(n,t.axes[e])}}},{key:"updateAxis",value:function(t,e){if(t&&null!=e&&NaN!==e){var n="-"===t[0],o=e*(n?-1:1);if(Math.abs(o)<this.props.deadZone&&(o=0),n&&(t=t.substr(1)),this.padState.axis[t]!==o){var r=this.padState.axis[t];this.padState.axis[t]=o,this.props.onAxisChange(t,o,r),"LeftStickX"===t&&(r<=this.props.stickThreshold&&o>this.props.stickThreshold&&this.props.onRight(),r>=-this.props.stickThreshold&&o<-this.props.stickThreshold&&this.props.onLeft()),"LeftStickY"===t&&(r<=this.props.stickThreshold&&o>this.props.stickThreshold&&this.props.onUp(),r>=-this.props.stickThreshold&&o<-this.props.stickThreshold&&this.props.onDown())}}}},{key:"buttonIndexToButtonName",value:function(t){var e=this.props.layout;return e.buttons&&e.buttons.length>=t+1?e.buttons[t]:null}},{key:"buttonIndexToAxisName",value:function(t){var e=this.props.layout;return e.buttonAxis&&e.buttonAxis.length>=t+1?e.buttonAxis[t]:null}},{key:"axisIndexToAxisName",value:function(t){var e=this.props.layout;return e.axis&&e.axis.length>=t+1?e.axis[t]:null}},{key:"render",value:function(){return f.default.Children.only(this.props.children)}}]),e}();v.defaultProps={layout:h.XBOX,stickThreshold:.5,deadZone:.08,gamepadIndex:0,onConnect:function(){},onDisconnect:function(){},onButtonDown:function(){},onButtonUp:function(){},onButtonChange:function(){},onAxisChange:function(){},onA:function(){},onB:function(){},onX:function(){},onY:function(){},onStart:function(){},onBack:function(){},onLT:function(){},onRT:function(){},onLB:function(){},onRB:function(){},onLS:function(){},onRS:function(){},onUp:function(){},onDown:function(){},onLeft:function(){},onRight:function(){}},s.default=v,Object.defineProperty(a,"__esModule",{value:!0}),a.layouts=a.Gamepad=void 0;var y=m(s),g=m(u);function m(t){return t&&t.__esModule?t:{default:t}}y.default.layouts=g.default,a.Gamepad=y.default,a.layouts=g.default;var b=a.default=y.default;let k;const w=new Uint8Array(16);function x(){if(!k&&(k="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!k))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return k(w)}var S=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;const _=[];for(let t=0;t<256;++t)_.push((t+256).toString(16).slice(1));function C(t,e=0){return(_[t[e+0]]+_[t[e+1]]+_[t[e+2]]+_[t[e+3]]+"-"+_[t[e+4]]+_[t[e+5]]+"-"+_[t[e+6]]+_[t[e+7]]+"-"+_[t[e+8]]+_[t[e+9]]+"-"+_[t[e+10]]+_[t[e+11]]+_[t[e+12]]+_[t[e+13]]+_[t[e+14]]+_[t[e+15]]).toLowerCase()}function R(t){if(!function(t){return"string"==typeof t&&S.test(t)}(t))throw TypeError("Invalid UUID");let e;const n=new Uint8Array(16);return n[0]=(e=parseInt(t.slice(0,8),16))>>>24,n[1]=e>>>16&255,n[2]=e>>>8&255,n[3]=255&e,n[4]=(e=parseInt(t.slice(9,13),16))>>>8,n[5]=255&e,n[6]=(e=parseInt(t.slice(14,18),16))>>>8,n[7]=255&e,n[8]=(e=parseInt(t.slice(19,23),16))>>>8,n[9]=255&e,n[10]=(e=parseInt(t.slice(24,36),16))/1099511627776&255,n[11]=e/4294967296&255,n[12]=e>>>24&255,n[13]=e>>>16&255,n[14]=e>>>8&255,n[15]=255&e,n}function P(t,e,n){function o(t,o,r,i){var a;if("string"==typeof t&&(t=function(t){t=unescape(encodeURIComponent(t));const e=[];for(let n=0;n<t.length;++n)e.push(t.charCodeAt(n));return e}(t)),"string"==typeof o&&(o=R(o)),16!==(null===(a=o)||void 0===a?void 0:a.length))throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let s=new Uint8Array(16+t.length);if(s.set(o),s.set(t,o.length),s=n(s),s[6]=15&s[6]|e,s[8]=63&s[8]|128,r){i=i||0;for(let t=0;t<16;++t)r[i+t]=s[t];return r}return C(s)}try{o.name=t}catch(t){}return o.DNS="6ba7b810-9dad-11d1-80b4-00c04fd430c8",o.URL="6ba7b811-9dad-11d1-80b4-00c04fd430c8",o}function L(t){return 14+(t+64>>>9<<4)+1}function E(t,e){const n=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(n>>16)<<16|65535&n}function A(t,e,n,o,r,i){return E((a=E(E(e,t),E(o,i)))<<(s=r)|a>>>32-s,n);var a,s}function B(t,e,n,o,r,i,a){return A(e&n|~e&o,t,e,r,i,a)}function M(t,e,n,o,r,i,a){return A(e&o|n&~o,t,e,r,i,a)}function T(t,e,n,o,r,i,a){return A(e^n^o,t,e,r,i,a)}function I(t,e,n,o,r,i,a){return A(n^(e|~o),t,e,r,i,a)}P("v3",48,(function(t){if("string"==typeof t){const e=unescape(encodeURIComponent(t));t=new Uint8Array(e.length);for(let n=0;n<e.length;++n)t[n]=e.charCodeAt(n)}return function(t){const e=[],n=32*t.length,o="0123456789abcdef";for(let r=0;r<n;r+=8){const n=t[r>>5]>>>r%32&255,i=parseInt(o.charAt(n>>>4&15)+o.charAt(15&n),16);e.push(i)}return e}(function(t,e){t[e>>5]|=128<<e%32,t[L(e)-1]=e;let n=1732584193,o=-271733879,r=-1732584194,i=271733878;for(let e=0;e<t.length;e+=16){const a=n,s=o,u=r,l=i;n=B(n,o,r,i,t[e],7,-680876936),i=B(i,n,o,r,t[e+1],12,-389564586),r=B(r,i,n,o,t[e+2],17,606105819),o=B(o,r,i,n,t[e+3],22,-1044525330),n=B(n,o,r,i,t[e+4],7,-176418897),i=B(i,n,o,r,t[e+5],12,1200080426),r=B(r,i,n,o,t[e+6],17,-1473231341),o=B(o,r,i,n,t[e+7],22,-45705983),n=B(n,o,r,i,t[e+8],7,1770035416),i=B(i,n,o,r,t[e+9],12,-1958414417),r=B(r,i,n,o,t[e+10],17,-42063),o=B(o,r,i,n,t[e+11],22,-1990404162),n=B(n,o,r,i,t[e+12],7,1804603682),i=B(i,n,o,r,t[e+13],12,-40341101),r=B(r,i,n,o,t[e+14],17,-1502002290),o=B(o,r,i,n,t[e+15],22,1236535329),n=M(n,o,r,i,t[e+1],5,-165796510),i=M(i,n,o,r,t[e+6],9,-1069501632),r=M(r,i,n,o,t[e+11],14,643717713),o=M(o,r,i,n,t[e],20,-373897302),n=M(n,o,r,i,t[e+5],5,-701558691),i=M(i,n,o,r,t[e+10],9,38016083),r=M(r,i,n,o,t[e+15],14,-660478335),o=M(o,r,i,n,t[e+4],20,-405537848),n=M(n,o,r,i,t[e+9],5,568446438),i=M(i,n,o,r,t[e+14],9,-1019803690),r=M(r,i,n,o,t[e+3],14,-187363961),o=M(o,r,i,n,t[e+8],20,1163531501),n=M(n,o,r,i,t[e+13],5,-1444681467),i=M(i,n,o,r,t[e+2],9,-51403784),r=M(r,i,n,o,t[e+7],14,1735328473),o=M(o,r,i,n,t[e+12],20,-1926607734),n=T(n,o,r,i,t[e+5],4,-378558),i=T(i,n,o,r,t[e+8],11,-2022574463),r=T(r,i,n,o,t[e+11],16,1839030562),o=T(o,r,i,n,t[e+14],23,-35309556),n=T(n,o,r,i,t[e+1],4,-1530992060),i=T(i,n,o,r,t[e+4],11,1272893353),r=T(r,i,n,o,t[e+7],16,-155497632),o=T(o,r,i,n,t[e+10],23,-1094730640),n=T(n,o,r,i,t[e+13],4,681279174),i=T(i,n,o,r,t[e],11,-358537222),r=T(r,i,n,o,t[e+3],16,-722521979),o=T(o,r,i,n,t[e+6],23,76029189),n=T(n,o,r,i,t[e+9],4,-640364487),i=T(i,n,o,r,t[e+12],11,-421815835),r=T(r,i,n,o,t[e+15],16,530742520),o=T(o,r,i,n,t[e+2],23,-995338651),n=I(n,o,r,i,t[e],6,-198630844),i=I(i,n,o,r,t[e+7],10,1126891415),r=I(r,i,n,o,t[e+14],15,-1416354905),o=I(o,r,i,n,t[e+5],21,-57434055),n=I(n,o,r,i,t[e+12],6,1700485571),i=I(i,n,o,r,t[e+3],10,-1894986606),r=I(r,i,n,o,t[e+10],15,-1051523),o=I(o,r,i,n,t[e+1],21,-2054922799),n=I(n,o,r,i,t[e+8],6,1873313359),i=I(i,n,o,r,t[e+15],10,-30611744),r=I(r,i,n,o,t[e+6],15,-1560198380),o=I(o,r,i,n,t[e+13],21,1309151649),n=I(n,o,r,i,t[e+4],6,-145523070),i=I(i,n,o,r,t[e+11],10,-1120210379),r=I(r,i,n,o,t[e+2],15,718787259),o=I(o,r,i,n,t[e+9],21,-343485551),n=E(n,a),o=E(o,s),r=E(r,u),i=E(i,l)}return[n,o,r,i]}(function(t){if(0===t.length)return[];const e=8*t.length,n=new Uint32Array(L(e));for(let o=0;o<e;o+=8)n[o>>5]|=(255&t[o/8])<<o%32;return n}(t),8*t.length))}));var O={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};function j(t,e,n){if(O.randomUUID&&!e&&!t)return O.randomUUID();const o=(t=t||{}).random||(t.rng||x)();if(o[6]=15&o[6]|64,o[8]=63&o[8]|128,e){n=n||0;for(let t=0;t<16;++t)e[n+t]=o[t];return e}return C(o)}function D(t,e,n,o){switch(t){case 0:return e&n^~e&o;case 1:case 3:return e^n^o;case 2:return e&n^e&o^n&o}}function U(t,e){return t<<e|t>>>32-e}P("v5",80,(function(t){const e=[1518500249,1859775393,2400959708,3395469782],n=[1732584193,4023233417,2562383102,271733878,3285377520];if("string"==typeof t){const e=unescape(encodeURIComponent(t));t=[];for(let n=0;n<e.length;++n)t.push(e.charCodeAt(n))}else Array.isArray(t)||(t=Array.prototype.slice.call(t));t.push(128);const o=t.length/4+2,r=Math.ceil(o/16),i=new Array(r);for(let e=0;e<r;++e){const n=new Uint32Array(16);for(let o=0;o<16;++o)n[o]=t[64*e+4*o]<<24|t[64*e+4*o+1]<<16|t[64*e+4*o+2]<<8|t[64*e+4*o+3];i[e]=n}i[r-1][14]=8*(t.length-1)/Math.pow(2,32),i[r-1][14]=Math.floor(i[r-1][14]),i[r-1][15]=8*(t.length-1)&4294967295;for(let t=0;t<r;++t){const o=new Uint32Array(80);for(let e=0;e<16;++e)o[e]=i[t][e];for(let t=16;t<80;++t)o[t]=U(o[t-3]^o[t-8]^o[t-14]^o[t-16],1);let r=n[0],a=n[1],s=n[2],u=n[3],l=n[4];for(let t=0;t<80;++t){const n=Math.floor(t/20),i=U(r,5)+D(n,a,s,u)+l+e[n]+o[t]>>>0;l=u,u=s,s=U(a,30)>>>0,a=r,r=i}n[0]=n[0]+r>>>0,n[1]=n[1]+a>>>0,n[2]=n[2]+s>>>0,n[3]=n[3]+u>>>0,n[4]=n[4]+l>>>0}return[n[0]>>24&255,n[0]>>16&255,n[0]>>8&255,255&n[0],n[1]>>24&255,n[1]>>16&255,n[1]>>8&255,255&n[1],n[2]>>24&255,n[2]>>16&255,n[2]>>8&255,255&n[2],n[3]>>24&255,n[3]>>16&255,n[3]>>8&255,255&n[3],n[4]>>24&255,n[4]>>16&255,n[4]>>8&255,255&n[4]]}));!function(t,e){void 0===e&&(e={});var n=e.insertAt;if(t&&"undefined"!=typeof document){var o=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css","top"===n&&o.firstChild?o.insertBefore(r,o.firstChild):o.appendChild(r),r.styleSheet?r.styleSheet.cssText=t:r.appendChild(document.createTextNode(t))}}('.cursor {\n  /* left: 50%; */\n  width: 100%;\n  height: 100%;\n  /* cursor: none; */\n\n  position: fixed;\n  /* top: 50%; */\n  /* transform: translate(-50%, -50%); */\n  /* border-radius: 100%; */\n}\n.virtual-joystic {\n  top: 0;\n  left: 0;\n  background-color: inherit;\n  position: fixed;\n  height: 100vh;\n  width: 100vw;\n  z-index: 9999999999999999999999999999999999999999999999999 !important;\n  /* display: flex; */\n  /* flex-direction: column; */\n  /* justify-content: space-between; */\n  /* align-items: flex-end; */\n}\n.joystics-wrapper {\n  position: absolute;\n  /* opacity: 0.8; */\n\n  display: flex;\n  width: 100%;\n  height: 27%;\n  justify-content: space-between;\n\n  align-self: flex-end;\n  bottom: 25%;\n}\n.space {\n  width: 40px;\n}\n.joystic-container {\n  /* filter: drop-shadow(0 0 0.75rem black); */\n  border-radius: 100%;\n}\n.VirtualJoystickButton-wrapper {\n  position: absolute;\n  right: 18%;\n  bottom: 15%;\n  /* filter: drop-shadow(0 0 0.4rem black); */\n  /* width: 25%;\n  height: 50%; */\n\n  display: grid;\n  grid-template-areas:\n    ". y ."\n    "x . b"\n    ". a .";\n}\n#Y {\n  grid-area: y;\n}\n#X {\n  grid-area: x;\n}\n#B {\n  grid-area: b;\n}\n#A {\n  grid-area: a;\n}\n\n.virtual-button {\n  opacity: 0.7;\n  border-radius: 100%;\n  background-color: lightgray;\n  font-size: larger;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  width: 60px;\n  height: 60px;\n  /* filter: drop-shadow(0 0 0.4rem black); */\n  border: 1px solid gray;\n}\n.shoulder {\n  position: absolute;\n  /* background-color: lightgray; */\n  font-size: larger;\n  display: flex;\n  flex-direction: column;\n  top: 25%;\n}\n.shoulder-button {\n  width: 70px;\n  height: 35px;\n  /* filter: drop-shadow(0 0 0.1rem black); */\n  border: 1px solid gray;\n  margin-bottom: 5px;\n  opacity: 0.7;\n  background-color: lightgray;\n}\n.right-shoulder {\n  right: 0;\n}\n.left-shoulder {\n  left: 0;\n}\n/* .VirtualJoystickButton-wrapper .text-button-wrapper {\n    background-color: gray;\n    border-radius: 50%;\n    height: 100%;\n    width: 100%;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n} */\n');var N={},J={},X={};!function(t){var e;Object.defineProperty(t,"__esModule",{value:!0}),t.JoystickShape=void 0,(e=t.JoystickShape||(t.JoystickShape={})).Circle="circle",e.Square="square"}(X);var Y={};Object.defineProperty(Y,"__esModule",{value:!0}),Y.shapeFactory=void 0;var z=X;Y.shapeFactory=function(t,e){switch(t){case z.JoystickShape.Circle:return{borderRadius:e};case z.JoystickShape.Square:return{borderRadius:Math.sqrt(e)}}};var F={};Object.defineProperty(F,"__esModule",{value:!0}),F.shapeBoundsFactory=void 0;var G=X;F.shapeBoundsFactory=function(t,e,n,o,r,i,a,s,u){return t===G.JoystickShape.Square?{relativeX:o=V(e-u.left-s/2,s),relativeY:r=V(n-u.top-s/2,s)}:(i>a&&(o*=a/i,r*=a/i),{relativeX:o,relativeY:r})};var q,V=function(t,e){var n=e/2;return t>n?n:t<-n?-1*n:t},W=i&&i.__extends||(q=function(t,e){return q=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},q(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}q(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),K=i&&i.__assign||function(){return K=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},K.apply(this,arguments)};Object.defineProperty(J,"__esModule",{value:!0}),J.Joystick=void 0;var Z,H,$=o.default,Q=X,tt=Y,et=F;!function(t){t.PointerDown="pointerdown",t.PointerMove="pointermove",t.PointerUp="pointerup"}(Z||(Z={})),function(t){t[t.TopRight=2.35619449]="TopRight",t[t.TopLeft=-2.35619449]="TopLeft",t[t.BottomRight=.785398163]="BottomRight",t[t.BottomLeft=-.785398163]="BottomLeft"}(H||(H={}));var nt=function(t){function e(e){var n,o=t.call(this,e)||this;return o._stickRef=$.createRef(),o._baseRef=$.createRef(),o._pointerId=null,o.state={dragging:!1},o._throttleMoveCallback=(n=0,function(t){var e=(new Date).getTime(),r=o.props.throttle||0;if(!(e-n<r))return n=e,o.props.move?o.props.move(t):void 0}),o}return W(e,t),e.prototype.componentWillUnmount=function(){var t=this;this.props.followCursor&&window.removeEventListener(Z.PointerMove,(function(e){return t._pointerMove(e)}))},e.prototype.componentDidMount=function(){var t=this;this.props.followCursor&&(this._parentRect=this._baseRef.current.getBoundingClientRect(),this.setState({dragging:!0}),window.addEventListener(Z.PointerMove,(function(e){return t._pointerMove(e)})),this.props.start&&this.props.start({type:"start",x:null,y:null,distance:null,direction:null}))},e.prototype._updatePos=function(t){var e=this;window.requestAnimationFrame((function(){e.setState({coordinates:t})})),"number"==typeof this.props.minDistance&&t.distance<this.props.minDistance||this._throttleMoveCallback({type:"move",x:t.relativeX,y:-t.relativeY,direction:t.direction,distance:t.distance})},e.prototype._pointerDown=function(t){var e=this;this.props.disabled||this.props.followCursor||(this._parentRect=this._baseRef.current.getBoundingClientRect(),this.setState({dragging:!0}),window.addEventListener(Z.PointerUp,(function(t){return e._pointerUp(t)})),window.addEventListener(Z.PointerMove,(function(t){return e._pointerMove(t)})),this._pointerId=t.pointerId,this._stickRef.current.setPointerCapture(t.pointerId),this.props.start&&this.props.start({type:"start",x:null,y:null,distance:null,direction:null}))},e.prototype._getDirection=function(t){return t>H.TopRight||t<H.TopLeft?"FORWARD":t<H.TopRight&&t>H.BottomRight?"RIGHT":t<H.BottomLeft?"LEFT":"BACKWARD"},e.prototype._distance=function(t,e){return Math.hypot(t,e)},e.prototype._distanceToPercentile=function(t){var e=t/(this._baseSize/2)*100;return e>100?100:e},e.prototype._pointerMove=function(t){if(t.preventDefault(),this.state.dragging){if(!this.props.followCursor&&t.pointerId!==this._pointerId)return;var e=t.clientX,n=t.clientY,o=e-this._parentRect.left-this._radius,r=n-this._parentRect.top-this._radius,i=this._distance(o,r),a=(0,et.shapeBoundsFactory)(this.props.controlPlaneShape||this.props.baseShape,e,n,o,r,i,this._radius,this._baseSize,this._parentRect);o=a.relativeX,r=a.relativeY;var s=Math.atan2(o,r);this._updatePos({relativeX:o,relativeY:r,distance:this._distanceToPercentile(i),direction:this._getDirection(s),axisX:e-this._parentRect.left,axisY:n-this._parentRect.top})}},e.prototype._pointerUp=function(t){var e=this;if(t.pointerId===this._pointerId){var n={dragging:!1};this.props.sticky||(n.coordinates=void 0),window.requestAnimationFrame((function(){e.setState(n)})),window.removeEventListener(Z.PointerUp,(function(t){return e._pointerUp(t)})),window.removeEventListener(Z.PointerMove,(function(t){return e._pointerMove(t)})),this._pointerId=null,this.props.stop&&this.props.stop({type:"stop",x:this.props.sticky?this.state.coordinates.relativeX:null,y:this.props.sticky?this.state.coordinates.relativeY:null,direction:this.props.sticky?this.state.coordinates.direction:null,distance:this.props.sticky?this.state.coordinates.distance:null})}},e.prototype.getBaseShapeStyle=function(){var t=this.props.baseShape||Q.JoystickShape.Circle;return(0,tt.shapeFactory)(t,this._baseSize)},e.prototype.getStickShapeStyle=function(){var t=this.props.stickShape||Q.JoystickShape.Circle;return(0,tt.shapeFactory)(t,this._baseSize)},e.prototype._getBaseStyle=function(){var t=void 0!==this.props.baseColor?this.props.baseColor:"#000033",e="".concat(this._baseSize,"px"),n=K(K({},this.getBaseShapeStyle()),{height:e,width:e,background:t,display:"flex",justifyContent:"center",alignItems:"center"});return this.props.baseImage&&(n.background="url(".concat(this.props.baseImage,")"),n.backgroundSize="100%"),n},e.prototype._getStickStyle=function(){var t=void 0!==this.props.stickColor?this.props.stickColor:"#3D59AB",e="".concat(this._baseSize/1.5,"px"),n=K(K({},this.getStickShapeStyle()),{background:t,cursor:"move",height:e,width:e,border:"none",flexShrink:0,touchAction:"none"});return this.props.stickImage&&(n.background="url(".concat(this.props.stickImage,")"),n.backgroundSize="100%"),void 0!==this.state.coordinates&&(n=Object.assign({},n,{position:"absolute",transform:"translate3d(".concat(this.state.coordinates.relativeX,"px, ").concat(this.state.coordinates.relativeY,"px, 0)")})),n},e.prototype.render=function(){var t=this;this._baseSize=this.props.size||100,this._radius=this._baseSize/2;var e=this._getBaseStyle(),n=this._getStickStyle();return $.createElement("div",{className:this.props.disabled?"joystick-base-disabled":"",ref:this._baseRef,style:e},$.createElement("button",{ref:this._stickRef,disabled:this.props.disabled,onPointerDown:function(e){return t._pointerDown(e)},className:this.props.disabled?"joystick-disabled":"",style:n}))},e}($.Component);J.Joystick=nt,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.JoystickShape=t.Joystick=void 0;var e=J;Object.defineProperty(t,"Joystick",{enumerable:!0,get:function(){return e.Joystick}});var n=X;Object.defineProperty(t,"JoystickShape",{enumerable:!0,get:function(){return n.JoystickShape}})}(N);var ot=function(t){var e=t.joysticOptions,n=t.onMove,r=t.onStop;return o.default.createElement(N.Joystick,{size:(null==e?void 0:e.size)?null==e?void 0:e.size:100,sticky:null!=(null==e?void 0:e.sticky)&&(null==e?void 0:e.sticky),baseColor:(null==e?void 0:e.baseColor)?null==e?void 0:e.baseColor:"gray",stickColor:(null==e?void 0:e.stickColor)?null==e?void 0:e.stickColor:"darkgray",baseImage:(null==e?void 0:e.baseImage)&&(null==e?void 0:e.baseImage),stickImage:(null==e?void 0:e.stickImage)&&(null==e?void 0:e.stickImage),stickShape:(null==e?void 0:e.stickShape)&&(null==e?void 0:e.stickShape),throttle:(null==e?void 0:e.throttle)&&(null==e?void 0:e.throttle),disabled:null!=(null==e?void 0:e.disabled)&&(null==e?void 0:e.disabled),baseShape:(null==e?void 0:e.baseShape)&&(null==e?void 0:e.baseShape),controlPlaneShape:(null==e?void 0:e.controlPlaneShape)&&(null==e?void 0:e.controlPlaneShape),minDistance:(null==e?void 0:e.minDistance)&&(null==e?void 0:e.minDistance),move:function(t){n&&n(t)},stop:function(t){r&&r(t)}})},rt=function(t,e,n){var o={x:e.x-t.x,y:e.y-t.y};return n?(0!=o.x&&(o.x=o.x/n),0!=o.y&&(o.y=o.y/n),o):o},it=function(t,e){if(e){if("RightTrigger"==e||"LeftTrigger"==e)return;var n=null,o=e.toLocaleLowerCase(),r=Number(t);if(!r&&0!=r)return void console.error("the values were not right, check your parameters");if("y"==o[o.length-1]&&(n="y"),"x"==o[o.length-1]&&(n="x"),!n)return void console.error("the values were not right, check your parameters");if("x"==n)return{x:r,y:null};if("y"==n)return{y:r,x:null}}else{if("number"==typeof t)return void console.error("error check first value sent");if(t.x&&t.y)return{x:t.x/50,y:t.y/50}}},at=function(t){var e=t.button,n=t.className,r=t.textColor;return e?o.default.createElement("button",{id:e.gamepadButton,onClick:function(){return e.onPress&&e.onPress()},className:n},o.default.createElement("b",{style:{color:r||"black"}},e.gamepadButton)):o.default.createElement("span",null)},st=function(t,e){e.forEach((function(e){var n;null===(n=null==t?void 0:t.vibrationActuator)||void 0===n||n.playEffect(t.vibrationActuator.type,{startDelay:0,duration:e,weakMagnitude:1,strongMagnitude:1})}))},ut=function(t){navigator.vibrate(t)};exports.InputManager=function(n){var i,a,s,u=n.keysGamepadControls,l=n.showVirtualJoysticOnNoGamepadMobile,c=n.children,d=n.virtualJoysticOptionsLeft,p=n.virtualJoysticOptionsRight,f=n.mouseSensetivity,h=n.hideMouseCursor,v=t.useState("keyboardMouse"),y=v[0],g=v[1],m=t.useState(),k=m[0],w=m[1],x=t.useState(null),S=x[0],_=x[1],C={x:0,y:0},R=t.useRef();t.useEffect((function(){var t=j(),e=document.createElement("div");return e.id=t,e.setAttribute("style","height: 100vh; width: 100vw; "),document.body.appendChild(e),_(document.getElementById(t)),function(){document.body.removeChild(e)}}),[]);var P=function(t){w(null),g("keyboardMouse");var e=t.key.toLowerCase();" "==t.key&&(e="space");var n=u.find((function(t){return t.keyboardKeyLowerCase==e}));n&&n.onPress&&n.onPress(t)},L=function(t){w(null),g("keyboardMouse");var e=t.key.toLowerCase();" "==t.key&&(e="space");var n=u.find((function(t){return t.keyboardKeyLowerCase==e}));n&&n.onRelase&&n.onRelase(t)},E=function(t){w(null),g("keyboardMouse"),i&&i(t)},A=function(t){w(null),g("keyboardMouse"),a&&a(t)},B=function(t){return"right"==t||"left"==t?u.find((function(e){return e.axisMouseOrGamePad==t})):u.find((function(e){return e.gamepadButton==t}))},M=function(t){var e={x:t.x,y:t.y},n=rt(e,C,f);s&&s(n),C=e},T=function(){document.removeEventListener("keydown",P),document.removeEventListener("keyup",L),document.removeEventListener("click",E),document.removeEventListener("contextmenu",A),document.removeEventListener("mousemove",M)};t.useEffect((function(){I()&&g("virtualJoystic")}),[]),t.useEffect((function(){var t,e,n;return"virtualJoystic"==y?T():(T(),a=null===(t=u.find((function(t){return t.isMouseClickMenu})))||void 0===t?void 0:t.onPress,i=null===(e=u.find((function(t){return t.isMouseClickLeft})))||void 0===e?void 0:e.onPress,s=null===(n=u.find((function(t){return t.axisMouseOrGamePad})))||void 0===n?void 0:n.onPress,a&&document.addEventListener("contextmenu",A),i&&document.addEventListener("click",E),s&&document.addEventListener("mousemove",M),document.addEventListener("keydown",P),document.addEventListener("keyup",L)),function(){T()}}),[y,JSON.stringify(u)]);var I=function(){var t=r();return("iphone"==t&&!k||"android"==t&&!k)&&l};return S&&e.createPortal(o.default.createElement(o.default.Fragment,null,o.default.createElement("div",{ref:R,className:"cursor",style:{cursor:h?"none":""}},o.default.createElement(b,{onConnect:function(t){g("gamepad");var e=navigator.getGamepads();e[t]&&w(e[t])},onAxisChange:function(t,e,n){var o;t.toLocaleLowerCase().includes("right")&&((o=B("right"))&&o.onPress&&o.onPress(it(e,t)));t.toLocaleLowerCase().includes("left")&&((o=B("left"))&&o.onPress&&o.onPress(it(e,t)))},onButtonChange:function(t,e){var n=function(t){return u.find((function(e){return e.gamepadButton==t}))}(t);e?(w(navigator.getGamepads()[0]),g("gamepad"),n&&n.onPress&&n.onPress()):n&&n.onRelase&&n.onRelase()}},o.default.createElement(o.default.Fragment,null)),I()&&o.default.createElement("div",{className:"virtual-joystic"},o.default.createElement("div",{className:"joystics-wrapper"},o.default.createElement("span",{className:"joystic-container",style:{position:"absolute",left:"40px",bottom:0}},B("left")&&o.default.createElement(ot,{joysticOptions:p,onMove:function(t){var e=B("left");e&&e.onPress&&e.onPress(it(t))},onStop:function(t){var e=B("left");e&&e.onRelase&&e.onRelase(t)}})),o.default.createElement("div",{className:"VirtualJoystickButton-wrapper"},o.default.createElement(at,{button:B("A"),className:"virtual-button",textColor:"green"}),o.default.createElement(at,{button:B("Y"),className:"virtual-button",textColor:"yellow"}),o.default.createElement(at,{button:B("X"),className:"virtual-button",textColor:"blue"}),o.default.createElement(at,{button:B("B"),className:"virtual-button",textColor:"red"})),o.default.createElement("span",{className:"joystic-container",style:{position:"absolute",right:"40px",bottom:0}},B("right")&&o.default.createElement(ot,{joysticOptions:d,onMove:function(t){var e=B("right");e&&e.onPress&&e.onPress(it(t))},onStop:function(t){var e=B("right");e&&e.onRelase&&e.onRelase(t)}}))),o.default.createElement("div",null,o.default.createElement("span",{className:"left-shoulder shoulder"},o.default.createElement(at,{button:B("LT"),className:"shoulder-button"}),o.default.createElement(at,{button:B("LB"),className:"shoulder-button"})),o.default.createElement("span",{className:"right-shoulder shoulder"},o.default.createElement(at,{button:B("RT"),className:"shoulder-button"}),o.default.createElement(at,{button:B("RB"),className:"shoulder-button"})))),c)),S)},exports.VirtualJoystic=ot,exports.calcCursorPoints=rt,exports.getAxisCalc=it,exports.getPlatform=r,exports.vibrate=function(t){var e=r(),n=navigator.getGamepads()[0];(n||"android"==e||"iphone"==e)&&(!(null==n?void 0:n.id.toLocaleLowerCase().includes("kishi"))&&"android"!=e||"iphone"==e?n&&st(n,t):ut(t))};
//# sourceMappingURL=index.js.map
